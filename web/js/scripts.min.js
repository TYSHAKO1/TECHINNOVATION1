var tablerows=0;function addRow(){tablerows+=1;var e=document.getElementById("formrow"),t=document.getElementById("gpaform").tBodies[0],o=e.cloneNode(!0),n="formrow"+tablerows.toString();o.id=n,t.appendChild(o);for(var d=document.getElementById(n).childNodes,l=0;l<d.length;l++)d[l].valueOf().hasChildNodes()&&(d[l].valueOf().childNodes[0].id=d[l].valueOf().childNodes[0].id[0]+tablerows.toString())}function compileData(){for(var e=[],t=document.getElementById("gpaform").tBodies[0].rows.length,o=0;o<t-1;o++){var n=[],d="g"+o.toString(),l="c"+o.toString(),a="w"+o.toString(),r="n"+o.toString();"other"==document.getElementById(d).value&&(o=o),n.push([document.getElementById(d).value,document.getElementById(l).value,document.getElementById(a).checked,document.getElementById(r).value]),e.push(n)}return console.log(e),e}function csvToArray(){return[["Grade (%)",0,60,63,67,70,73,77,80,83,87,90,93],["Grade (Letter)","F","D-","D","D+","C-","C","C+","B-","B","B+","A-","A"],["GP(UW)",0,.7,1,1.3,1.7,2,2.3,2.7,3,3.3,3.7,4],["GP(W)",0,.7,1,1.3,1.9,2.2,2.5,3.1,3.4,3.7,4.3,4.6]]}function calculateGPA(){for(var e=compileData(),t=csvToArray(),o=0,n=0,d=0,l=0;l<e.length;l++)for(var a=0;a<e[l].length;a++){var r=e[l][a],g=r[0],c=parseInt(r[1]);"other"!=g&&(d+=c,r[2]?(o+=t[3][t[1].indexOf(g)]*c,n+=t[2][t[1].indexOf(g)]*c):(o+=t[2][t[1].indexOf(g)]*c,n+=t[2][t[1].indexOf(g)]*c))}return uwgpa=n/d,wgpa=o/d,[uwgpa.toFixed(3),wgpa.toFixed(3)]}function submit(){gpas=calculateGPA(),uwgpa=gpas[0],wgpa=gpas[1],document.getElementById("uwgpa").innerText=uwgpa,document.getElementById("wgpa").innerText=wgpa}function deleteLastAddedRow(){0!=tablerows&&(document.getElementById("formrow"+tablerows.toString()).remove(),tablerows-=1)}function saveGrades(){var e=new Blob([compileData()],{type:"text/plain;charset=utf-8"});saveAs(e,"SHS_GPA_Calculator.txt")}function upload(){const[e]=document.querySelector("#myfile").files,t=new FileReader;t.addEventListener("load",()=>{var e=t.result,o="";console.log(e);for(var n=0,d=0;n<e.length;n++)","==e[n]&&(d+=1,console.log(d)),4!=d?o+=e[n]:(o+="\n",d=0,console.log("com"));console.log(o),e=o.split("\n"),console.log(e);for(var l=0;l<e.length;l++)e[l]=e[l].split(",");sendToTable(e)},!1),e&&t.readAsText(e)}function sendToTable(e){for(;0!=tablerows;)deleteLastAddedRow();for(var t=0;t<e.length;t++){var o=e[t];document.getElementById("g"+t.toString()).value=o[0],document.getElementById("c"+t.toString()).value=o[1],document.getElementById("w"+t.toString()).checked="true"==o[2],document.getElementById("n"+t.toString()).value=o[3],addRow()}deleteLastAddedRow(),submit()}
